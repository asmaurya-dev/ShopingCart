
@{
    ViewData["Title"] = "Product";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- CKEditor CDN -->
    <script src="https://cdn.ckeditor.com/4.16.0/standard/ckeditor.js"></script>
    <!-- SweetAlert2 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>

    <button class="btn btn-danger float-end" data-toggle="modal" data-target="#Modal">Add New Product</button>
    <h3>Add Product</h3>

    <div class="modal fade" id="Modal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel">Add Product</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" enctype="multipart/form-data">
                        <input type="hidden" id="IdForUpdateCategory" />
                        <div class="form-group">
                            <label for="cat_Id"><b>Category Name</b></label>
                            <select name="CategoryId" class="form-control my-2" id="cat_Id" required>
                                <option selected disabled>Select Category</option>

                            </select>
                        </div>
                        <div class="form-group">
                            <label for="product_name">Product Name:</label>
                            <input type="text" class="form-control" id="product_name" name="ProductName" required />
                        </div>
                        <div class="form-group">
                            <label for="product_price">Product Price:</label>
                            <input type="text" class="form-control" id="product_price" name="productPrice" required />
                        </div>
                        <div class="form-group">
                            <label for="product_description">Product Description:</label>
                            <textarea class="form-control" id="product_description" name="productDescription" required></textarea>
                        </div>
                        <div class="form-group form-check">
                            <input type="checkbox" class="form-check-input" id="isactive" name="IsActive" value="true">
                            <label class="form-check-label" for="isactive">Is Active</label>
                        </div>
                        <div class="form-group">
                            <label for="product_Image">Product Image:</label>
                            <input type="file" accept="image/*" class="form-control" id="product_Image" name="file" />
                            <img id="blah" src="#" height="50" width="80" alt="your image" />
                        </div>
                       
                       
                      

                        <button type="submit" class="btn btn-primary">Add Product</button>
                       
                    </form>
                </div>
            </div>
        </div>
    </div>

    <table id="tbl" class="border border-5 table table-bordered" style="background:#ddddee">
        <thead>
            <tr>
                <th>ProductName</th>
                <th>ProductPrice</th>
                <th>ProductDesc</th>
                <th>CategoryId</th>
                <th>IsActive</th>
                <th>EntryDate</th>
                <th>ProductImage</th>
                <th>CategoryName</th>
                <th style="padding-left:50px">Action</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        product_Image.onchange = evt => {
            const [file] = product_Image.files
            if (file) {
                blah.src = URL.createObjectURL(file)
            }
        }
        CKEDITOR.replace('product_description');
        $(document).ready(function () {
            SelectCategoryById();
            GetAllCategoryForDropdown();
        });
        
        function SelectCategoryById() {

            $.ajax({
                url: '/Admin/GetProductList',
                type: 'GET',

                success: function (res) {
                    debugger;
                    for (var x of res) {
                        $('#tbl tbody').append(`<tr>
                                        <td>${x.id}</td>
                                                <td>${x.productName}</td>
        <td>${x.productDescription}</td>
                <td>${x._ProductImage}</td>
                                        <td>${x.isActive}</td>
                                                <td>${x.entryDate}</td>
                                             

                                               <td>${x.productImage}</td>
                                                          <td>${x.categoryName}</td>
                                              
                                               <td>${x.productImage}</td>
                                             <td>
                                            <button class='btn btn-success'  data-toggle="modal" data-target="#myModal">Update</button>
                                            <button class='btn btn-danger' >Delete</button>
                                        </td>
                                    </tr>`);

                    }
                }

            })
        }

        function GetAllCategoryForDropdown() {

            $.ajax({
                url: '/Admin/CategoryListForDropdown',
                type: 'GET',

                success: function (res) {
                    debugger;
                    for (var x of res) {
                       
                        $('#cat_Id').append(`<option value="${x.categoryId}"> ${x.categoryName} </option>`)
                    }
                }

            })
        }
        // function AddAndUpdateProduct()
        // {
        //     var categoryName = document.getElementById("cat_Id").value;
        //     var productName = document.getElementById("product_name").value;
        //     var productPrice = document.getElementById("product_price").value;
        //     var productDescription = document.getElementById("product_description").value;
        //     var isActive = document.getElementById("isactive").checked;
        //     var productImage = document.getElementById("product_Image").files[0];
        //     var obj = {
        //         ProductName: productName,
        //         ProductImage: productImage,
        //         ProductPrice: productPrice,
        //         ProductDescription: productDescription,
        //         IsActive: isActive,
        //         CategoryId: categoryName
        //     };

        //     $.ajax({
        //         url: '/Admin/AddOrUpdateProduct',
        //         type: 'POST',
        //         data: obj,
        //         success: function (res) {
        //             debugger;
                   
        //             Swal.fire({
        //                 icon: "success",
        //                 title: res,
        //                 text: 'Thank you',
        //                 timer: 5000,
        //                 showConfirmButton: true,
        //                 showCloseButton: true,
        //                 showCancelButton: true,
        //                 timerProgressBar: true
        //             });
        //             getAllCategory();
        //         }
        //     });
        // }
      
    </script>

</body>
</html>
