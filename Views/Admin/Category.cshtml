@{
    ViewData["Title"] = "Home Page";
}
<body class="body">
<h4>
    <span>CATEGORY LIST</span>
    <button type="button" class="btn btn-primary float-end" data-toggle="modal" data-target="#myModal">
        Add category
    </button>
</h4>
<div id="DivPrtCategoryList">

</div>
<div class="container mt-5" >
    <!-- The Modal -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h5 class="modal-title">Add Category</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <form id="categoryForm">
                        <input type="text" id="hdnCategoryId" hidden />
                        <div class="form-group">
                            <label for="Category">Category Name</label>
                            <input type="text" id="Category" class="form-control" placeholder="Enter the Category name" />
                        </div>
                        <div class="form-group">
                            <label for="check">IsActive</label>
                            <input type="checkbox" id="check" checked />
                        </div>
                    </form>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" id="btn" >Submit</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
        $(document).ready(function () {
            GetCategoryList();
            $('#btn').click(function () {
                try {
                    var formIsValid = true;
                    var categoryName = $('#Category').val();
                    if (!categoryName) {
                        formIsValid = false;
                        $('#Category').css('border', '1px solid red');
                    }

                    if (formIsValid) {
                        AddOrUpdateCategory();

                        setTimeout(function () {
                            $("#btn").text("Submit");
                            $('#Category').css('border', '');
                            $('#hdnCategoryId').val('');
                            $('#Category').val('');
                            $('.modal-title').text('Add category');
                            $("#check").prop("checked", true);
                        }, 500); // 500ms delay before executing the changes
                    }
                } catch (error) {
                    console.log(error);
                }
            });

            $('.modal .close, .modal-footer .btn-danger').click(function () {
                try {
                    setTimeout(function () {
                        $('#myModal').modal('hide').on('hidden.bs.modal', function () {
                            $('#hdnCategoryId').val('');
                            $('#Category').val('');
                            $("#check").prop("checked", true);
                            $('.modal-title').text('Add category');
                            $("#btn").text("Submit");
                            $('#Category').css('border', '');
                            afterModalHidden();
                        });
                        $('#hdnCategoryId').val('');
                        $('#Category').val('');
                        $("#check").prop("checked", true);
                        $('.modal-title').text('Add category');
                        $("#btn").text("Submit");
                        $('#Category').css('border', '');
                    }, 500); // 500ms delay before executing the changes
                } catch (error) {
                    console.log(error);
                }
            });
        });


        function GetCategoryList() {
            try {
                $.ajax({
                    url: '/Admin/PrtCategoryList',
                    type: 'GET',
                    success: function (response) {
                        $("#DivPrtCategoryList").html(response);
                    },
                    error: function () {
                        // Handle error if needed
                    }
                });
            } catch (error) {
                console.log(error);
            }
        }


        function AddOrUpdateCategory() {
            try {
                var categoryName = $('#Category').val();
                var isActive = $("#check").prop("checked");
                var categoryId = $('#hdnCategoryId').val();
                var obj = {
                    CategoryName: categoryName,
                    IsActive: isActive,
                    CategoryId: categoryId
                };
                $.ajax({
                    url: '/Admin/AddOrUpdateCategory',
                    type: 'POST',
                    data: obj,
                    success: function (res) {
                        try {
                            var statusCode = res.status;
                            var message = res.message;
                            if (statusCode == 1) {
                                Swal.fire({
                                    icon: "success",
                                    title: message,
                                    text: 'Thank you',
                                    timer: 5000,
                                    showConfirmButton: true,
                                    showCloseButton: true,
                                    showCancelButton: true,
                                    timerProgressBar: true
                                });
                                GetCategoryList();
                                $('#myModal').trigger('click');
                                $('#myModal').modal('hide');
                            }
                            if (statusCode == -1) {
                                Swal.fire({
                                    icon: "error",
                                    title: message,
                                    text: ' sorry ',
                                    timer: 5000,
                                    showConfirmButton: true,
                                    showCloseButton: true,
                                    showCancelButton: true,
                                    timerProgressBar: true
                                });
                                GetCategoryList();
                                $('#myModal').trigger('click');
                                $('#myModal').modal('hide');
                            }
                        } catch (error) {
                            console.log(error);
                        }
                    }
                });
            } catch (error) {
                console.log(error);
            }
        }

        function DeleteCategory(CategoryID) {
            try {
                $.ajax({
                    url: '/Admin/DeleteCategory',
                    type: 'GET',
                    data: { CategoryID: CategoryID },
                    success: function (res) {
                        Swal.fire({
                            icon: "success",
                            title: 'Data Deleted Successfully',
                            text: 'Thank you',
                            timer: 5000,
                            showConfirmButton: true,
                            showCloseButton: true,
                            showCancelButton: true,
                            timerProgressBar: true
                        });
                        GetCategoryList();
                    }
                });
            } catch (error) {
                console.log(error);
            }
        }

        function GetCategoryById(categoryID) {
            try {
                $.ajax({
                    url: '/Admin/GetCategoryById',
                    type: 'GET',
                    data: { CategoryID: categoryID },
                    success: function (res) {
                        try {
                            for (var x of res) {
                                $("#Category").val(x.categoryName);
                                $("#hdnCategoryId").val(x.categoryId);
                                $("#check").prop("checked", x.isActive ? true : false);
                                $('.modal-title').text('Update category');
                                $("#btn").text("Update");
                            }
                        } catch (error) {
                            console.log(error);
                        }
                    }
                });
            } catch (error) {
                console.log(error);
            }
        }

        function alphabetOnly() {
            try {
                var digitRegex = /[^a-zA-Z\s]+/g;
                var x1 = document.getElementById("Category");
                var x = x1.value;

                x1.value = x.replace(digitRegex, '');

                if (x.trim() === "") {
                    return false;
                } else {
                    var a = /^[A-Za-z\s]+$/;
                    if (a.test(x)) {
                        return true;
                    } else {
                        return false;
                    }
                }
            } catch (error) {
                console.log(error);
            }
        }

        // Add event listener to validate input on change
        document.getElementById("Category").addEventListener("input", alphabetOnly);

</script>
</body>